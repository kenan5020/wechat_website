<include file="Public:head"/>
<link rel="stylesheet" href="{noercms::STATICS}/vote/style.css" />
<script src="{noercms::RES}/js/date/WdatePicker.js"></script>
<script src="{noercms::STATICS}/vote/common.js"></script>
<link rel="stylesheet" type="text/css" href="{noercms::RES}/css/cymain.css" />
<script src="/tpl/static/artDialog/jquery.artDialog.js?skin=default"></script>
<script src="/tpl/static/artDialog/plugins/iframeTools.js"></script>
<link rel="stylesheet" href="{noercms::STATICS}/kindeditor/themes/default/default.css" />
<link rel="stylesheet" href="{noercms::STATICS}/kindeditor/plugins/code/prettify.css" />
<script src="{noercms::STATICS}/kindeditor/kindeditor.js" type="text/javascript"></script>
<script src="{noercms::STATICS}/kindeditor/lang/zh_CN.js" type="text/javascript"></script>
<script src="{noercms::STATICS}/kindeditor/plugins/code/prettify.js" type="text/javascript"></script>
<script src="./tpl/User/default/common/js/cart/jscolor.js" type="text/javascript"></script>
<script type="text/javascript" src="/tpl/User/default/common/js/jquery.js"></script>
<script>
var editor;
KindEditor.ready(function(K) {
editor = K.create('#intro', {
resizeType : 1,
allowPreviewEmoticons : false,
allowImageUpload : true,
uploadJson : '/index.php?g=User&m=Upyun&a=kindedtiropic',
items : [
'source','undo','clearhtml','hr',
'removeformat', '|', 'justifyleft', 'justifycenter', 'justifyright', 'insertorderedlist',
'insertunorderedlist', '|', 'emoticons', 'image','link', 'unlink','baidumap','lineheight','table','anchor','preview','print','template','code','cut']
});
});
</script>
<div class="content"  >
<div class="cLineB">
  <h4> <if condition="$vo['type'] neq 'img'"> 文本<else/>图片</if>投票设置 </h4><a href="{noercms::U('Vote/index')}" class="right btnGrayS vm" style="margin-top:-27px">返回</a>
 </div>
         <div class="msgWrap bgfc">
<form class="form" method="post" action="" target="_top" enctype="multipart/form-data">	 
<table class="userinfoArea" style=" margin:0;" border="0" cellspacing="0" cellpadding="0" width="100%"><tbody><tr>
<th width="120">关键词：</th>
<td><input type="text" name="keyword" value="<if condition="$vo['keyword'] eq ''">投票<else/>{noercms:$vo.keyword}</if>" class="px" style="width:550px;"><br><span class="red">只能写一个关键词,功能面板必须开启投票</span></td>
</tr>
                            <tr>
<th width="120">投票标题：</th>
<td><input type="text" name="title" value="{noercms:$vo.title}" class="px" style="width:550px;"></td>
</tr>
<tr>
<th>投票图片：</th>
<td><img class="thumb_img" id="picurl_src" src="{noercms:$reslist['picurl']|default='./tpl/static/attachment/focus/default/1.gif'}" style="max-height:100px;"><input type="text" name="picurl" value="{noercms:$vo.picurl|default='./tpl/static/attachment/focus/default/1.gif'}" class="px" onclick="document.getElementById('picurl_src').src=this.value;" id="picurl" style="width:300px;"> 
 <script src="/tpl/static/upyun.js"></script><a href="###" onclick="upyunPicUpload('picurl',700,400,'{noercms:$vo.token}')" class="a_upload">上传</a> <a href="###" onclick="viewImg('picurl')">预览</a>&nbsp;填写图片外链地址，大小为720x400</td>
</tr>
<tr>
<th>图片显示：</th>
<td><label>
<input type="radio" name="showpic" value="1" checked="checked" id="showpic2">
显示在投票页面</label>
<label>
<input name="showpic" type="radio" id="showpic1" value="0">
不显示在投票页面</label>
</td>
</tr>
<tr>
<th valign="top">投票说明：</th>
<td valign="top"><textarea class="px" id="info" name="info" style="width: 560px; height: 120px; display: ;"><?php echo html_entity_decode(htmlspecialchars_decode($vo['info'])); ?></textarea></td>
</tr>
<tr>
<th valign="top">投票选项：</th>
<td valign="top"><div class="bdrcontent">
<div id="div_ptype">
<table class="ListProduct" border="0" cellspacing="0" cellpadding="0" width="100%">
<tbody>
<tr>
    <td width="50">序号</td>
    <td width="260">选项标题</td>
    <td width="50">排序</td>
     <td width="50">票数</td>
    <if condition="$vo['type'] eq 'img' OR $type eq 'img'">
    <td width="260">图片外链地址</td>
    <td width="260">图片跳转地址以http://开头</td>
    </if>
    <td class="norightborder"></td>
</tr>
</tbody>
<if condition="$items neq ''">
<tbody>
<volist name="items" id="ivo">
<tr>
    <td width="50"><input type="text" name="add[id][]" readonly="readonly"  value="{noercms:$ivo.id}" style="width:50px;"></td>
    <td width="260"><input type="text" name="add[item][]" value="{noercms:$ivo.item}" class="px" style="width:240px;"></td>
    <td width="50"><input type="text" name="add[rank][]" value="{noercms:$ivo.rank|default=1}" style="width:50px;" class="px"></td>
    <td width="50"><input type="text" name="add[vcount][]" value="{noercms:$ivo.vcount}" style="width:50px;" class="px"></td>
    <if condition="$vo['type'] eq 'img' OR $type eq 'img'">
    <td width="260"><input type="text" name="add[startpicurl][]" value="{noercms:$ivo.startpicurl}" style="width:50px;" class="px"></td>
    <td width="260"><input type="text" name="add[tourl][]" value="{noercms:$ivo.tourl|default='#'}" style="width:50px;" class="px"></td>
    </if>   
    <td width="50" class="norightborder"><a href="javascript:;" onclick="delrow(this, 'div_add_del');">删除</a></td>
</tr>
</volist>
</tbody>
 </if>
<tbody id="div_add_del" name="div_add_del">    
    <tr style="display:none">
      <td width="50"><input type="text" name="add[id][]" readonly="readonly" disabled="disabled"  value="" style="width:50px;" ></td>
        <td width="200">
            <input type="text" name="add[item][]" value="" class="px" style="width:150px;">
        </td>
        <td>
            <input type="text" name="add[rank][]" value="{noercms:$ivo.rank|default=1}" style="width:50px;" class="px">
        </td>
         <td>
            <input type="text" name="add[vcount][]" value="0" style="width:50px;" class="px">
        </td>
        <if condition="($vo['type'] eq 'img') OR ($type eq 'img')">
             <td width="80"><input type="text" name="add[startpicurl][]" value="" class="px" style="width:190px;"></td>
             <td width="100"><input type="text" name="add[tourl][]" value="#" class="px" style="width:100px;"></td>
         </if>
         <td width="50" class="norightborder"><a href="javascript:;" onclick="delrow(this, 'div_add_del');">删除</a></td>
    </tr>
</tbody>
    <tbody>
        <tr>
            <td colspan="4" class="norightborder"> 
                <button type="button" id="vtype" onclick="addrow('div_add_del');" class="btnGrayS vm" value="true"><strong>添加选项</strong></button>至少2项,最多15项,已经添加[<span id='aditem'>{noercms:$count}</span>]项</td>
               
        </tr>
  </tbody>
</table>
<script>
var count = <php>echo $count+1;</php>;
function addrow(tbody) {
var add = false;
var newnode;
if($$(tbody).rows.length == 1 && $$(tbody).rows[0].style.display == 'none') {
$$(tbody).rows[0].style.display = '';
newnode = $$(tbody).rows[0];
} else {
newnode = $$(tbody).rows[0].cloneNode(true);
add = true;
}
if(add) {
$$(tbody).appendChild(newnode);
}
var aditem = document.getElementById('aditem');
aditem.innerHTML=count;
if(count==15){var vtype = document.getElementById('vtype');
vtype.disabled="disabled";vtype.value="disabled";}count++;
}
function delrow(obj, tbody) {
if($$(tbody).rows.length == 1) {
var trobj = obj.parentNode.parentNode;
$(trobj).remove();
}else{
$$(tbody).removeChild(obj.parentNode.parentNode);
}
}</script>  
</div>
</div>
</td>
</tr>
<tr>
<th>单选/多选：</th>
<td><p style="width: 120px; float: left; display: block; line-height: 32px; height: 32px;">
<label>
<input name="rtype" type="radio" onclick="document.getElementById('cknums').style.display='none';" id="RadioGroup1_0" value="0" <if condition="$vo['rtype'] eq 0">checked</if>>
单选</label>
<label>
<input type="radio" <if condition="$vo['rtype'] eq 1">checked</if> name="rtype" onclick="document.getElementById('cknums').style.display='block';" value="1" id="RadioGroup1_1">
多选</label></p>
<p id="cknums"  style="display:<if condition="$vo['rtype'] eq 0">none</if>;width:200px; float: left">
<input name="cknums" <if condition="$vo['rtype'] neq 1">checked</if> class="px" size="4" type="text" value="{noercms:$vo.cknums|default=1}">多项最多选多少项
</p></td>
</tr>
<tr>
<th>截至时间：</th>
<td><input type="input" class="px" id="statdate" value="<if condition="$vo['statdate'] neq ''">{noercms:$vo.statdate|date="Y-m-d",###}</if>" onClick="WdatePicker()" name="statdate">
到
<input type="input" class="px" id="enddate" value="<if condition="$vo['enddate'] neq ''">{noercms:$vo.enddate|date="Y-m-d",###}</if>" name="enddate" onClick="WdatePicker()"></td>
</tr>
<tr>
<th>投票结果：</th>
<td>
<label>
<input name="display" type="radio" <if condition="$vo['display'] eq 1">checked</if>  value="1" id="RadioGroup2_1">
投票前可见</label>
<label>
<input name="display" type="radio" <if condition="$vo['display'] eq 0">checked <else/> checked</if> id="RadioGroup2_0" value="0">
投票后可见</label>
<label>
<input name="display" type="radio" <if condition="$vo['display'] eq 2">checked</if>id="RadioGroup2_2" value="2">
投票结束可见</label>
</td>
</tr>
<tr>
<th>&nbsp;</th>
<td><button type="submit" name="button" class="btnGreen">保存</button>
<a href="{noercms::U('Vote/index')}" class="btnGray vm">取消</a>
</td>
</tr>
</tbody>
</table>  
</form>
  </div> 
        </div>
<include file="Public:footer"/>